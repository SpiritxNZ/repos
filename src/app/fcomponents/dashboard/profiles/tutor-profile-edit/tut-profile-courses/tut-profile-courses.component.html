<div *ngIf="errorObj.hasError" class="error-feedback">{{errorObj.errorMessage}}</div>

<!-- <div  *ngIf="message!=''" class="success-feedback"  >
    {{message}}
  </div> -->

  <div  *ngIf="courses==null"   >
      <span class="error-feedback">Oops! No course found!,please add one first.</span>
    <button type="button" class="btn  btn-link ml-5" data-toggle="modal"
            data-target="#addModal" >Add</button>
  </div>
  
<!--card--->
  <div class="card mb-2  " *ngFor="let course of courses"  style="margin-top: 25px; border-radius:10px">
    <h3 class="card-header border-solid m2" style="border-radius:5px;font-style: Arial; ">{{course.course_title}}</h3>
    <ul class="card-body  ">
        <ul class="row">
            <ul class="list-group col-sm-6 "  >
                <li class="list-group-item border-light">ID: {{course.id}}</li>
                <!---type 0 1 2-->
                <li class="list-group-item border-light" *ngIf="course.course_type===1">Type: Flat</li>
                <li class="list-group-item border-light" *ngIf="course.course_type===2">Type: Trail</li>
                <li class="list-group-item border-light" *ngIf="course.course_type===3">Type: Package</li>
                <li class="list-group-item border-light" *ngIf="!course.course_type">Type: </li>
                <li class="list-group-item border-light">Subtitle: {{course.course_subtitle}}</li>
            </ul>
            <ul class="list-group col-sm-6 ">
                <li class="list-group-item border-light">Price: {{course.course_price| currency:"USD":"symbol"}}</li>
                <li class="list-group-item border-light">Length: {{course.course_length}}</li>
            </ul>
        </ul>
    </ul>
    
    <div class=" border-solid">
        <!--button-->
        <button type="button" class="btn  btn-link ml-5" data-toggle="modal"
            data-target="#addModal" >Add</button>
        <button type="button" class="btn  btn-link" data-toggle="modal"
            data-target="#editModal" (click)="onSelect(course)">Edit Price</button>
        <button type="button" class="btn  btn-link " data-toggle="modal"
            data-target="#deleteModal" (click)="onSelect(course)">Delete</button>    
    </div>
</div>


<!---editmodal-->
<div class="modal fade " id="editModal" tabindex="-1" role="dialog" 
aria-hidden="true">

<div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
        <div class="modal-header  border-light" style="background-color:rgb(235, 233, 231);">
            <h5 class="modal-title" >Edit your price</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <form #updForm="ngForm" class="modal-body">
            <div *ngIf="selectedCourse">
                <h3>{{selectedCourse.course_title}}</h3>
                <br>
                <ul class="row">
                    <ul class="list-group col-xs-6 ">
                        <li class="list-group-item border-light">
                            <p class="h6">Course ID:</p>
                        </li>
                        <li class="list-group-item border-light">
                            <p class="h6">Course type:</p>
                        </li>
                        <li class="list-group-item border-light">
                            <p class="h6">Course length:</p>
                        </li>

                        <li class="list-group-item border-light">
                            <p class="h6">Course subtitle:</p>
                        </li>
                    </ul>
                    <ul class="list-group col-xs-6 " >
                        <li class="list-group-item border-light" >
                            <p class="h6">{{selectedCourse.id}} </p>
                        </li>
                        <li class="list-group-item border-light" *ngIf="selectedCourse.course_type===1">
                            <p class="h6">Flat</p>
                        </li>
                        <li class="list-group-item border-light" *ngIf="selectedCourse.course_type===2">
                            <p class="h6">Trail</p>
                        </li>
                        <li class="list-group-item border-light" *ngIf="selectedCourse.course_type===3">
                            <p class="h6">Package</p>
                        </li>
                        <li class="list-group-item border-light" *ngIf="!selectedCourse.course_type">
                                <p class="h6"></p>
                            </li>
                        <li class="list-group-item border-light">
                            <p class="h6">{{selectedCourse.course_length}} </p>
                        </li>
                        <li class="list-group-item border-light">
                            <p class="h6">{{selectedCourse.course_subtitle}}</p>
                        </li>
                    </ul>
                </ul>
                <h5>Edit your course price</h5>
                <div class="input-group mb-3 ">
                    <div class="input-group-prepend">
                        <span class="input-group-text">$</span>
                    </div>
                    <input type="text" #newPrice="ngModel" class="input-group-text form-control" [(ngModel)]="selectedCourse.course_price" name="course_price"
                        placeholder="{{selectedCourse.course_price}}" style="max-width: 100px;" (blur)="fireEvent($event)" [ngClass]="{'is-invalid':newPrice.errors}" required
                        pattern="^([1-9][0-9]{,2}(,[0-9]{3})*|[0-9]+)(\.[0-9]{1,9})?$"/>
                        <div [hidden]="!newPrice.errors?.required" class="invalid-feedback">Price required!</div>
                        <div [hidden]="!newPrice.errors?.pattern" class="invalid-feedback">Price is not valid!</div>
                </div>
            </div>
            <div class="modal-footer">
                    <button type="button" class="btn btn-outline-primary" data-dismiss="modal" [disabled]="!updForm.form.valid" (click)="updateCourse();">Confirm Edit</button>
                <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Close</button>
            </div>
        </form>
    </div>
</div>
</div>


<!--deletemodal--->
<div class="modal fade " id="deleteModal"  aria-hidden="true">
<div *ngIf="selectedCourse">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header  border-light" style="background-color:rgb(235, 233, 231);">
                <h5 class="modal-title" >Are you sure to delete
                    {{selectedCourse.course_title}} ?</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <h3>{{selectedCourse.course_title}}</h3>
                <br>
                <ul class="row">
                    <ul class="list-group col-xs-6 ">
                        <li class="list-group-item border-light">
                            <p class="h6">Course ID:</p>
                        </li>
                        <li class="list-group-item border-light">
                            <p class="h6">Course type:</p>
                        </li>
                        <li class="list-group-item border-light">
                            <p class="h6">Course length:</p>
                        </li>

                        <li class="list-group-item border-light">
                            <p class="h6">Course subtitle:</p>
                        </li>
                        <li class="list-group-item border-light">
                            <p class="h6">Course price:</p>
                        </li>

                    </ul>
                    <ul class="list-group col-xs-6 " >
                        <li class="list-group-item border-light">
                            <p class="h6">{{selectedCourse.id}} </p>
                        </li>
                        <li class="list-group-item border-light" *ngIf="selectedCourse.course_type===1">
                            <p class="h6">Flat</p>
                        </li>
                        <li class="list-group-item border-light" *ngIf="selectedCourse.course_type===2">
                            <p class="h6">Trail</p>
                        </li>
                        <li class="list-group-item border-light" *ngIf="selectedCourse.course_type===3">
                            <p class="h6">Package</p>
                        </li>
                        <li class="list-group-item border-light" *ngIf="!selectedCourse.course_type">
                                <p class="h6"></p>
                            </li>

                        <li class="list-group-item border-light">
                            <p class="h6">{{selectedCourse.course_length}} </p>
                        </li>

                        <li class="list-group-item border-light">
                            <p class="h6">{{selectedCourse.course_subtitle}}</p>
                        </li>
                        <li class="list-group-item border-light">
                            <p class="h6">{{selectedCourse.course_price}}</p>
                        </li>
                    </ul>
                </ul>

            </div>
            <div class="modal-footer">
                <button class="btn btn-outline-primary float-left" (click)="removeCourse(selectedCourse);  "
                    data-dismiss="modal">
                    Confirm Delete
                </button>

            </div>
        </div>
    </div>
</div>
</div>


<!--addmodal--->
<div class="modal fade " id="addModal">
    <div class="modal-dialog modal-dialog-centered" >
        <div class="modal-content">
            <div class="modal-header border-light" style="background-color:rgb(235, 233, 231);">
                <h5 class="modal-title" >Add your course</h5>
                <button  class="close" data-dismiss="modal"  (click)="clearChangedCourse()">
                    <span >&times;</span></button>
            </div>
            <div class="modal-body">
            <form #addForm="ngForm">
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <label class="input-group-text" >Course Options</label>
                    </div>
                    <select #courseName (change)="onChange($event.target.value)" class="custom-select"
                        name="courseName" data-target="#changedcourse" aria-labelledby="changedcourseLabel">
                        <option selected>Choose new course</option>
                        <option *ngFor="let course of courses1" value={{course|json}}>{{course.course_title}}</option>
                    </select>
                </div>
                <div *ngIf="changedCourse ">
                    <h3>{{changedCourse.course_title}}</h3>
                    <br>
                    <ul class="row">
                        <ul class="list-group col-xs-6 ">
                            <li class="list-group-item border-light">
                                <p class="h6">Course type:</p>
                            </li>
                            <li class="list-group-item border-light">
                                <p class="h6">Course length:</p>
                            </li>
                            <li class="list-group-item border-light">
                                <p class="h6">Course subtitle:</p>
                            </li>
                            <li class="list-group-item border-light">
                                <p class="h6">Package price:</p>
                            </li>
                        </ul>
                        <ul class="list-group col-xs-6 "  >
                            <li class="list-group-item border-light" *ngIf="changedCourse.course_type===1">
                                <p class="h6">Flat</p>
                            </li>
                            <li class="list-group-item border-light" *ngIf="changedCourse.course_type===2">
                                <p class="h6">Trail</p>
                            </li>
                            <li class="list-group-item border-light" *ngIf="changedCourse.course_type===3">
                                <p class="h6">Package</p>
                            </li>
                            <li class="list-group-item border-light" *ngIf="!changedCourse.course_type">
                                    <p class="h6"></p>
                                </li>
                            <li class="list-group-item border-light">
                                <p class="h6">{{changedCourse.course_length}} </p>
                            </li>
                            <li class="list-group-item border-light">
                                <p class="h6">{{changedCourse.course_subtitle}}</p>
                            </li>
                            <li class="list-group-item border-light inline">
                                <input type="hidden" [(ngModel)]="changedCourse.course_id" name="course_id" #course_id/>                                                      
                                <input type="text" class="input-group-text  mb-5  w-50 form-control" [(ngModel)]="changedCourse.course_price" name="course_price" #coursePrice="ngModel"
                                [ngClass]="{'is-invalid':coursePrice.errors && coursePrice.touched }" required 
                                pattern="^([1-9][0-9]{,2}(,[0-9]{3})*|[0-9]+)(\.[0-9]{1,9})?$"
                                />
                                <div [hidden]="!coursePrice.errors?.required" class="invalid-feedback">Price required!</div>
                                <div [hidden]="!coursePrice.errors?.pattern" class="invalid-feedback">Price is not valid!</div>
                                <small *ngIf="warning!=''" class="form-text text-danger" >{{warning}}</small> 
                                <button *ngIf="!warningFlag" class="btn btn-outline-primary float-left"  [disabled]= "!addForm.form.valid" (click)="addCourse(course_id.value,coursePrice.value);"
                                data-dismiss="modal">
                                add
                            </button>
                            <button *ngIf="warningFlag" class="btn btn-outline-primary float-left" [disabled]="warningFlag"  (click)="addCourse(course_id.value,coursePrice.value);"
                                data-dismiss="modal">
                            add
                        </button>
                            </li>
                        </ul>
                    </ul>



                  
                    <div class="modal-footer">
                        
                            

                    </div>
             
                </div>
            
            </form>
        </div>
        </div>
    
   

</div>